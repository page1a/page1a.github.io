<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2、Java实现可交易钱包 | 程序员练功房</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/logo.ico">
    <meta name="description" content="纵然出走时未曾想要流浪半生，归来时早已发现少年不再">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.466dd957.js" as="script"><link rel="preload" href="/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/assets/js/14.9c4dc8e5.js" as="script"><link rel="prefetch" href="/assets/js/10.fc32896f.js"><link rel="prefetch" href="/assets/js/11.3a98615b.js"><link rel="prefetch" href="/assets/js/12.0fd6f044.js"><link rel="prefetch" href="/assets/js/13.736846a1.js"><link rel="prefetch" href="/assets/js/15.120590aa.js"><link rel="prefetch" href="/assets/js/16.f46ba600.js"><link rel="prefetch" href="/assets/js/17.f96e2b9e.js"><link rel="prefetch" href="/assets/js/18.5dae5acc.js"><link rel="prefetch" href="/assets/js/19.957d727a.js"><link rel="prefetch" href="/assets/js/20.c957c720.js"><link rel="prefetch" href="/assets/js/21.db4d26e7.js"><link rel="prefetch" href="/assets/js/22.9d19bebe.js"><link rel="prefetch" href="/assets/js/23.b5390312.js"><link rel="prefetch" href="/assets/js/24.289c8fcd.js"><link rel="prefetch" href="/assets/js/25.f7baec4a.js"><link rel="prefetch" href="/assets/js/26.2704ae01.js"><link rel="prefetch" href="/assets/js/27.5189ccb9.js"><link rel="prefetch" href="/assets/js/28.ed5cb93d.js"><link rel="prefetch" href="/assets/js/29.96717473.js"><link rel="prefetch" href="/assets/js/3.0c69ac0f.js"><link rel="prefetch" href="/assets/js/30.7331b634.js"><link rel="prefetch" href="/assets/js/31.d26d187f.js"><link rel="prefetch" href="/assets/js/32.7f286b45.js"><link rel="prefetch" href="/assets/js/33.173b2025.js"><link rel="prefetch" href="/assets/js/34.f31f4bb8.js"><link rel="prefetch" href="/assets/js/35.218fc470.js"><link rel="prefetch" href="/assets/js/36.ebcd9c43.js"><link rel="prefetch" href="/assets/js/37.09d876bc.js"><link rel="prefetch" href="/assets/js/38.3f7ba3d2.js"><link rel="prefetch" href="/assets/js/39.2ac20870.js"><link rel="prefetch" href="/assets/js/4.d12742be.js"><link rel="prefetch" href="/assets/js/40.c1d8f1bc.js"><link rel="prefetch" href="/assets/js/41.ebed8fef.js"><link rel="prefetch" href="/assets/js/42.c1d002b4.js"><link rel="prefetch" href="/assets/js/43.ef429b49.js"><link rel="prefetch" href="/assets/js/44.8adc98bb.js"><link rel="prefetch" href="/assets/js/45.cea62ac9.js"><link rel="prefetch" href="/assets/js/46.d4ffd3f4.js"><link rel="prefetch" href="/assets/js/47.07d237c5.js"><link rel="prefetch" href="/assets/js/48.0ae3a334.js"><link rel="prefetch" href="/assets/js/49.f0515684.js"><link rel="prefetch" href="/assets/js/5.216cae74.js"><link rel="prefetch" href="/assets/js/50.b6ada23c.js"><link rel="prefetch" href="/assets/js/51.6e351bfe.js"><link rel="prefetch" href="/assets/js/52.418a145d.js"><link rel="prefetch" href="/assets/js/53.298699f9.js"><link rel="prefetch" href="/assets/js/54.b3598a19.js"><link rel="prefetch" href="/assets/js/55.ce965562.js"><link rel="prefetch" href="/assets/js/56.bd957b43.js"><link rel="prefetch" href="/assets/js/57.d48da2b8.js"><link rel="prefetch" href="/assets/js/58.999b5a89.js"><link rel="prefetch" href="/assets/js/59.02363b1c.js"><link rel="prefetch" href="/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/assets/js/60.83e84781.js"><link rel="prefetch" href="/assets/js/61.4449c91d.js"><link rel="prefetch" href="/assets/js/62.56df5e89.js"><link rel="prefetch" href="/assets/js/63.f775d12d.js"><link rel="prefetch" href="/assets/js/64.8add4c27.js"><link rel="prefetch" href="/assets/js/65.346067ba.js"><link rel="prefetch" href="/assets/js/66.dee69efa.js"><link rel="prefetch" href="/assets/js/67.22ab30d5.js"><link rel="prefetch" href="/assets/js/68.0877349f.js"><link rel="prefetch" href="/assets/js/69.0ba59988.js"><link rel="prefetch" href="/assets/js/7.d02ea004.js"><link rel="prefetch" href="/assets/js/70.a02699db.js"><link rel="prefetch" href="/assets/js/8.55b047fc.js"><link rel="prefetch" href="/assets/js/9.22802293.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">程序员练功房</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/java_1.html" class="nav-link">
  jobHandler调度管理
</a></li><li class="dropdown-item"><!----> <a href="/Java/java_2.html" class="nav-link">
  jProtobuf尝鲜
</a></li><li class="dropdown-item"><!----> <a href="/SpringBoot/springboot_1.html" class="nav-link">
  使用Docker部署Spring Boot
</a></li><li class="dropdown-item"><!----> <a href="/SpringCloud/springcloud_1.html" class="nav-link">
  springcloud(一)：初识Spring Cloud
</a></li><li class="dropdown-item"><!----> <a href="/SpringCloud/springcloud_2.html" class="nav-link">
  springcloud(二)：注册中心Eureka
</a></li><li class="dropdown-item"><!----> <a href="/Java/java_3.html" class="nav-link">
  java8 toMap问题(key重复如何解决)
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="机器学习" class="dropdown-title"><span class="title">机器学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="机器学习" class="mobile-dropdown-title"><span class="title">机器学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Ai/ai_1.html" class="nav-link">
  机器学习笔记
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_2.html" class="nav-link">
  程序员数学笔记
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_3.html" class="nav-link">
  计算图和求导的链式法则
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_4.html" class="nav-link">
  卷积神经网络
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_5.html" class="nav-link">
  PyTorch学习
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BigData/bigdata_1.html" class="nav-link">
  使用Docker搭建Hadoop集群(伪分布式与完全分布式)
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="区块链" class="dropdown-title"><span class="title">区块链</span> <span class="arrow down"></span></button> <button type="button" aria-label="区块链" class="mobile-dropdown-title"><span class="title">区块链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlockChain/block_1.html" class="nav-link">
  1、Java实现简单区块链
</a></li><li class="dropdown-item"><!----> <a href="/BlockChain/block_2.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  2、Java实现可交易钱包
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Go" class="dropdown-title"><span class="title">Go</span> <span class="arrow down"></span></button> <button type="button" aria-label="Go" class="mobile-dropdown-title"><span class="title">Go</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Go/go_1.html" class="nav-link">
  go的基本命令详解
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_2.html" class="nav-link">
  gin框架使用案例
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_3.html" class="nav-link">
  gorm基本使用
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_4.html" class="nav-link">
  Golang操作Redis
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_5.html" class="nav-link">
  golang实现tcp通信
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_6.html" class="nav-link">
  Golang使用Protobuf 
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue3" class="dropdown-title"><span class="title">Vue3</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue3" class="mobile-dropdown-title"><span class="title">Vue3</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue3/vue_1.html" class="nav-link">
  Vue3 安装
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/vue_2.html" class="nav-link">
  Vue3 项目打包
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><span class="title">Linux</span> <span class="arrow down"></span></button> <button type="button" aria-label="Linux" class="mobile-dropdown-title"><span class="title">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Linux/linux_1.html" class="nav-link">
  虚拟机3种网络模式
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_2.html" class="nav-link">
  linux常用命令总结
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_3.html" class="nav-link">
  centos7部署FastDFS
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_4.html" class="nav-link">
  centos7中根据文件大小排序
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_5.html" class="nav-link">
  makefile项目管理demo
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_6.html" class="nav-link">
  nvm常用命令
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_7.html" class="nav-link">
  anaconda常用命令
</a></li><li class="dropdown-item"><!----> <a href="/Jenkins/jenkins_1.html" class="nav-link">
  快速安装Jenkins完美教程
</a></li><li class="dropdown-item"><!----> <a href="/Jenkins/jenkins_2.html" class="nav-link">
  Docker jenkins配置NPM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docker" class="dropdown-title"><span class="title">Docker</span> <span class="arrow down"></span></button> <button type="button" aria-label="Docker" class="mobile-dropdown-title"><span class="title">Docker</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Docker/docker_1.html" class="nav-link">
  Docker(一)：Docker入门教程
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_2.html" class="nav-link">
  Docker(二)：Dockerfile使用介绍
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_3.html" class="nav-link">
  Docker(三)：Dockerfile命令详解
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_4.html" class="nav-link">
  Docker(四)：Docker三剑客之Docker Compose
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_5.html" class="nav-link">
  Docker(五)：Docker三剑客之Docker Machine
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_6.html" class="nav-link">
  Docker(六)：Docker三剑客之Docker Swarm
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_7.html" class="nav-link">
  Docker安装MariaDB
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_9.html" class="nav-link">
  Docker安装Mysql8
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_8.html" class="nav-link">
  Docker安装Redis
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_10.html" class="nav-link">
  Docker安装Nacos
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_11.html" class="nav-link">
  Docker安装maven私有仓库
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_12.html" class="nav-link">
  Docker安装mongodb
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_13.html" class="nav-link">
  docker-compose.yml开发环境基础中间件配置
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="K8s" class="dropdown-title"><span class="title">K8s</span> <span class="arrow down"></span></button> <button type="button" aria-label="K8s" class="mobile-dropdown-title"><span class="title">K8s</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/K8s/k8s_1.html" class="nav-link">
  VirtualBox + centos7部署k8s
</a></li><li class="dropdown-item"><!----> <a href="/K8s/k8s_2.html" class="nav-link">
  kubectl常用命令
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Nginx" class="dropdown-title"><span class="title">Nginx</span> <span class="arrow down"></span></button> <button type="button" aria-label="Nginx" class="mobile-dropdown-title"><span class="title">Nginx</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/OpenResty/nginx.html" class="nav-link">
  Nginx 配置详解
</a></li><li class="dropdown-item"><!----> <a href="/OpenResty/nginx_2.html" class="nav-link">
  Nginx 常用命令
</a></li><li class="dropdown-item"><!----> <a href="/OpenResty/openresty_1.html" class="nav-link">
  OpenResty 使用介绍
</a></li><li class="dropdown-item"><!----> <a href="/OpenResty/openresty_2.html" class="nav-link">
  OpenResty(Nginx+Lua)测试用例
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="单变量微积分" class="dropdown-title"><span class="title">单变量微积分</span> <span class="arrow down"></span></button> <button type="button" aria-label="单变量微积分" class="mobile-dropdown-title"><span class="title">单变量微积分</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/SingleCalculus/SingleCalculus_5.html" class="nav-link">
  5. 指数函数和对数函数的导数
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="多变量微积分" class="dropdown-title"><span class="title">多变量微积分</span> <span class="arrow down"></span></button> <button type="button" aria-label="多变量微积分" class="mobile-dropdown-title"><span class="title">多变量微积分</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/MultivariableCalculus/MultivariableCalculus_1.html" class="nav-link">
  1. 偏导数
</a></li><li class="dropdown-item"><!----> <a href="/MultivariableCalculus/MultivariableCalculus_5.html" class="nav-link">
  5. 梯度与方向导数
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="线性代数" class="dropdown-title"><span class="title">线性代数</span> <span class="arrow down"></span></button> <button type="button" aria-label="线性代数" class="mobile-dropdown-title"><span class="title">线性代数</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linear/linear_1.html" class="nav-link">
  1. 矩阵的基本运算
</a></li><li class="dropdown-item"><!----> <a href="/linear/linear_2.html" class="nav-link">
  2. 向量（简介）
</a></li><li class="dropdown-item"><!----> <a href="/linear/linear_3.html" class="nav-link">
  3. 向量2（点积）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="概率论" class="dropdown-title"><span class="title">概率论</span> <span class="arrow down"></span></button> <button type="button" aria-label="概率论" class="mobile-dropdown-title"><span class="title">概率论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Probability/probability_1.html" class="nav-link">
  1. 独立事件下的简单概率
</a></li><li class="dropdown-item"><!----> <a href="/Probability/probability_2.html" class="nav-link">
  2. 古典概型
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow down"></span></button> <button type="button" aria-label="其它" class="mobile-dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Other/2019.1.2.html" class="nav-link">
  Vuepress搭建静态博客
</a></li><li class="dropdown-item"><!----> <a href="/Other/markdown.html" class="nav-link">
  Markdown基本语法
</a></li></ul></div></div><div class="nav-item"><a href="/Readme/index.html" class="nav-link">
  关于我
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Java/java_1.html" class="nav-link">
  jobHandler调度管理
</a></li><li class="dropdown-item"><!----> <a href="/Java/java_2.html" class="nav-link">
  jProtobuf尝鲜
</a></li><li class="dropdown-item"><!----> <a href="/SpringBoot/springboot_1.html" class="nav-link">
  使用Docker部署Spring Boot
</a></li><li class="dropdown-item"><!----> <a href="/SpringCloud/springcloud_1.html" class="nav-link">
  springcloud(一)：初识Spring Cloud
</a></li><li class="dropdown-item"><!----> <a href="/SpringCloud/springcloud_2.html" class="nav-link">
  springcloud(二)：注册中心Eureka
</a></li><li class="dropdown-item"><!----> <a href="/Java/java_3.html" class="nav-link">
  java8 toMap问题(key重复如何解决)
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="机器学习" class="dropdown-title"><span class="title">机器学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="机器学习" class="mobile-dropdown-title"><span class="title">机器学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Ai/ai_1.html" class="nav-link">
  机器学习笔记
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_2.html" class="nav-link">
  程序员数学笔记
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_3.html" class="nav-link">
  计算图和求导的链式法则
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_4.html" class="nav-link">
  卷积神经网络
</a></li><li class="dropdown-item"><!----> <a href="/Ai/ai_5.html" class="nav-link">
  PyTorch学习
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><span class="title">大数据</span> <span class="arrow down"></span></button> <button type="button" aria-label="大数据" class="mobile-dropdown-title"><span class="title">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BigData/bigdata_1.html" class="nav-link">
  使用Docker搭建Hadoop集群(伪分布式与完全分布式)
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="区块链" class="dropdown-title"><span class="title">区块链</span> <span class="arrow down"></span></button> <button type="button" aria-label="区块链" class="mobile-dropdown-title"><span class="title">区块链</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/BlockChain/block_1.html" class="nav-link">
  1、Java实现简单区块链
</a></li><li class="dropdown-item"><!----> <a href="/BlockChain/block_2.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  2、Java实现可交易钱包
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Go" class="dropdown-title"><span class="title">Go</span> <span class="arrow down"></span></button> <button type="button" aria-label="Go" class="mobile-dropdown-title"><span class="title">Go</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Go/go_1.html" class="nav-link">
  go的基本命令详解
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_2.html" class="nav-link">
  gin框架使用案例
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_3.html" class="nav-link">
  gorm基本使用
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_4.html" class="nav-link">
  Golang操作Redis
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_5.html" class="nav-link">
  golang实现tcp通信
</a></li><li class="dropdown-item"><!----> <a href="/Go/go_6.html" class="nav-link">
  Golang使用Protobuf 
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue3" class="dropdown-title"><span class="title">Vue3</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue3" class="mobile-dropdown-title"><span class="title">Vue3</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Vue3/vue_1.html" class="nav-link">
  Vue3 安装
</a></li><li class="dropdown-item"><!----> <a href="/Vue3/vue_2.html" class="nav-link">
  Vue3 项目打包
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><span class="title">Linux</span> <span class="arrow down"></span></button> <button type="button" aria-label="Linux" class="mobile-dropdown-title"><span class="title">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Linux/linux_1.html" class="nav-link">
  虚拟机3种网络模式
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_2.html" class="nav-link">
  linux常用命令总结
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_3.html" class="nav-link">
  centos7部署FastDFS
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_4.html" class="nav-link">
  centos7中根据文件大小排序
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_5.html" class="nav-link">
  makefile项目管理demo
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_6.html" class="nav-link">
  nvm常用命令
</a></li><li class="dropdown-item"><!----> <a href="/Linux/linux_7.html" class="nav-link">
  anaconda常用命令
</a></li><li class="dropdown-item"><!----> <a href="/Jenkins/jenkins_1.html" class="nav-link">
  快速安装Jenkins完美教程
</a></li><li class="dropdown-item"><!----> <a href="/Jenkins/jenkins_2.html" class="nav-link">
  Docker jenkins配置NPM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docker" class="dropdown-title"><span class="title">Docker</span> <span class="arrow down"></span></button> <button type="button" aria-label="Docker" class="mobile-dropdown-title"><span class="title">Docker</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Docker/docker_1.html" class="nav-link">
  Docker(一)：Docker入门教程
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_2.html" class="nav-link">
  Docker(二)：Dockerfile使用介绍
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_3.html" class="nav-link">
  Docker(三)：Dockerfile命令详解
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_4.html" class="nav-link">
  Docker(四)：Docker三剑客之Docker Compose
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_5.html" class="nav-link">
  Docker(五)：Docker三剑客之Docker Machine
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_6.html" class="nav-link">
  Docker(六)：Docker三剑客之Docker Swarm
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_7.html" class="nav-link">
  Docker安装MariaDB
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_9.html" class="nav-link">
  Docker安装Mysql8
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_8.html" class="nav-link">
  Docker安装Redis
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_10.html" class="nav-link">
  Docker安装Nacos
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_11.html" class="nav-link">
  Docker安装maven私有仓库
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_12.html" class="nav-link">
  Docker安装mongodb
</a></li><li class="dropdown-item"><!----> <a href="/Docker/docker_13.html" class="nav-link">
  docker-compose.yml开发环境基础中间件配置
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="K8s" class="dropdown-title"><span class="title">K8s</span> <span class="arrow down"></span></button> <button type="button" aria-label="K8s" class="mobile-dropdown-title"><span class="title">K8s</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/K8s/k8s_1.html" class="nav-link">
  VirtualBox + centos7部署k8s
</a></li><li class="dropdown-item"><!----> <a href="/K8s/k8s_2.html" class="nav-link">
  kubectl常用命令
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Nginx" class="dropdown-title"><span class="title">Nginx</span> <span class="arrow down"></span></button> <button type="button" aria-label="Nginx" class="mobile-dropdown-title"><span class="title">Nginx</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/OpenResty/nginx.html" class="nav-link">
  Nginx 配置详解
</a></li><li class="dropdown-item"><!----> <a href="/OpenResty/nginx_2.html" class="nav-link">
  Nginx 常用命令
</a></li><li class="dropdown-item"><!----> <a href="/OpenResty/openresty_1.html" class="nav-link">
  OpenResty 使用介绍
</a></li><li class="dropdown-item"><!----> <a href="/OpenResty/openresty_2.html" class="nav-link">
  OpenResty(Nginx+Lua)测试用例
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="单变量微积分" class="dropdown-title"><span class="title">单变量微积分</span> <span class="arrow down"></span></button> <button type="button" aria-label="单变量微积分" class="mobile-dropdown-title"><span class="title">单变量微积分</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/SingleCalculus/SingleCalculus_5.html" class="nav-link">
  5. 指数函数和对数函数的导数
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="多变量微积分" class="dropdown-title"><span class="title">多变量微积分</span> <span class="arrow down"></span></button> <button type="button" aria-label="多变量微积分" class="mobile-dropdown-title"><span class="title">多变量微积分</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/MultivariableCalculus/MultivariableCalculus_1.html" class="nav-link">
  1. 偏导数
</a></li><li class="dropdown-item"><!----> <a href="/MultivariableCalculus/MultivariableCalculus_5.html" class="nav-link">
  5. 梯度与方向导数
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="线性代数" class="dropdown-title"><span class="title">线性代数</span> <span class="arrow down"></span></button> <button type="button" aria-label="线性代数" class="mobile-dropdown-title"><span class="title">线性代数</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linear/linear_1.html" class="nav-link">
  1. 矩阵的基本运算
</a></li><li class="dropdown-item"><!----> <a href="/linear/linear_2.html" class="nav-link">
  2. 向量（简介）
</a></li><li class="dropdown-item"><!----> <a href="/linear/linear_3.html" class="nav-link">
  3. 向量2（点积）
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="概率论" class="dropdown-title"><span class="title">概率论</span> <span class="arrow down"></span></button> <button type="button" aria-label="概率论" class="mobile-dropdown-title"><span class="title">概率论</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Probability/probability_1.html" class="nav-link">
  1. 独立事件下的简单概率
</a></li><li class="dropdown-item"><!----> <a href="/Probability/probability_2.html" class="nav-link">
  2. 古典概型
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><span class="title">其它</span> <span class="arrow down"></span></button> <button type="button" aria-label="其它" class="mobile-dropdown-title"><span class="title">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Other/2019.1.2.html" class="nav-link">
  Vuepress搭建静态博客
</a></li><li class="dropdown-item"><!----> <a href="/Other/markdown.html" class="nav-link">
  Markdown基本语法
</a></li></ul></div></div><div class="nav-item"><a href="/Readme/index.html" class="nav-link">
  关于我
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2、java实现可交易钱包"><a href="#_2、java实现可交易钱包" class="header-anchor">#</a> 2、Java实现可交易钱包</h1> <h2 id="本章目标"><a href="#本章目标" class="header-anchor">#</a> 本章目标</h2> <ul><li>创建一个简单的钱包。</li> <li>使用我们的区块链发送带签名的交易。</li></ul> <p>我们已经有了一个基本的区块链，但在区块链中存放的是一些无用的信息。今天我们将用交易取代这些信息（我们的区块将能够保存多个交易），允许我们创建一个非常简单的加密货币,我们的货币名字NoobCoin。</p> <ul><li>本教程是在上一边基础上实现的</li> <li>导入 bounceycastle和GSON</li></ul> <h2 id="准备一个钱包"><a href="#准备一个钱包" class="header-anchor">#</a> 准备一个钱包</h2> <p>在加密货币中，在区块链作为交易时，货币所有权可以进行转移，每个参与者都有一个自己私有的地址来发送或者是收取货币。，钱包可以存储这些地址。因此钱包就是可以在区块链上进行新交易的软件。
</p><p><img src="/BlockChain/block_2/block_2-1.png" alt=""><br></p><p></p> <p>让我们创建一个钱包类来保存公钥和私钥:</p> <div class="language- extra-class"><pre class="language-text"><code>package noobchain;
import java.security.*;

public class Wallet {
	public PrivateKey privateKey;
	public PublicKey publicKey;
}
</code></pre></div><p>公钥和私钥究竟是起到什么作用呢，其实公钥的作用就是地址，你可以分享你的公钥给别人以此来获取付款，而你的私钥的作用是为了对交易进行签名，这样其他人就不可以花费你的金额除非它拥有你的私钥，所以对于每个人而言我们必须保护好我们的私钥，不能透露我们的私钥信息给其他人。同时在我们进行交易的时候我们也会同时发送我们的公钥由此来验证我们的签名是有效的而且没有数据被篡改。</p> <p>我们在密钥对KeyPair生成私有和公钥。我们将使用椭圆曲线加密来生成我们的密钥对KeyPair。让我们将generateKeyPair()方法添加到我们的钱包类中，并在构造函数中调用它:</p> <p>私钥用于签署我们不想被篡改的数据。公钥用于验证签名。</p> <div class="language- extra-class"><pre class="language-text"><code>package noobchain;
import java.security.*;

public class Wallet {
	
	public PrivateKey privateKey;
	public PublicKey publicKey;
	
	public Wallet(){
		generateKeyPair();	
	}
		
	public void generateKeyPair() {
		try {
			KeyPairGenerator keyGen = KeyPairGenerator.getInstance(&quot;ECDSA&quot;,&quot;BC&quot;);
			SecureRandom random = SecureRandom.getInstance(&quot;SHA1PRNG&quot;);
			ECGenParameterSpec ecSpec = new ECGenParameterSpec(&quot;prime192v1&quot;);
			// Initialize the key generator and generate a KeyPair
			keyGen.initialize(ecSpec, random);   //256 bytes provides an acceptable security level
	        	KeyPair keyPair = keyGen.generateKeyPair();
	        	// Set the public and private keys from the keyPair
	        	privateKey = keyPair.getPrivate();
	        	publicKey = keyPair.getPublic();
		}catch(Exception e) {
			throw new RuntimeException(e);
		}
	}
	
}
</code></pre></div><p>现在我们已经又了钱包类的大概框架，下面我们再来看一下交易类。</p> <h2 id="交易和数字签名"><a href="#交易和数字签名" class="header-anchor">#</a> 交易和数字签名</h2> <p>每笔交易将携带一定以下信息：</p> <ul><li>资金付款人的公匙信息。</li> <li>资金收款人的公匙信息。</li> <li>被转移资金的金额。</li> <li>输入，它是对以前的交易的引用，证明发送者有资金发送。</li> <li>输出，显示交易中收款方相关地址数量。(这些输出被引用为新交易的输入)</li> <li>一个加密签名，证明该交易是由地址的发送者是发送的，并且数据没有被更改。(阻止第三方机构更改发送的数量)</li></ul> <p>让我们创建这个新的交易类：</p> <div class="language- extra-class"><pre class="language-text"><code>import java.security.*;
import java.util.ArrayList;

public class Transaction {
	
	public String transactionId; // this is also the hash of the transaction.
	public PublicKey sender; // senders address/public key.
	public PublicKey reciepient; // Recipients address/public key.
	public float value;
	public byte[] signature; // this is to prevent anybody else from spending funds in our wallet.
	
	public ArrayList&lt;TransactionInput&gt; inputs = new ArrayList&lt;TransactionInput&gt;();
	public ArrayList&lt;TransactionOutput&gt; outputs = new ArrayList&lt;TransactionOutput&gt;();
	
	private static int sequence = 0; // a rough count of how many transactions have been generated. 
	
	// Constructor: 
	public Transaction(PublicKey from, PublicKey to, float value,  ArrayList&lt;TransactionInput&gt; inputs) {
		this.sender = from;
		this.reciepient = to;
		this.value = value;
		this.inputs = inputs;
	}
	
	// This Calculates the transaction hash (which will be used as its Id)
	private String calulateHash() {
		sequence++; //increase the sequence to avoid 2 identical transactions having the same hash
		return StringUtil.applySha256(
				StringUtil.getStringFromKey(sender) +
				StringUtil.getStringFromKey(reciepient) +
				Float.toString(value) + sequence
				);
	}
}
</code></pre></div><p>我们还应该创建空的transactioninput和transactionoutput类，不要担心我们可以在后面填写它们。</p> <p>我们的交易类还将包含生成/验证签名和验证交易的相关方法，那么签名的意图是什么？签名在我们的区块链中执行了两个非常重要的任务：第一，签名用来保证只有货币的拥有者才可以用来发送自己的货币，第二，签名用来阻止其他人试图篡改提交的交易</p> <ul><li>即私钥被用来签名数据，而公钥用来验证其完整性。</li></ul> <p>举个例子：Bob 想要发送2个加密货币给Sally，他们用各自的钱包创建了交易，并提交到全网的区块链中作为一个新的区块，一个挖矿者试图篡改接受者把2个加密货币给John，但是幸运的事，Bob在交易数据中已经用私钥进行了签名，这就允许了全网中的任何节点使用小明的公匙进行验证数据是否已经被篡改（因为没有其他人的公钥可以用来验证小明发出的这笔交易）。</p> <p>从前面的代码中我们可以看到我们的签名将是一堆字符串，所以让我们创建一个方法来生成它们。首先我们在StringUtil类中创建产生签名的方法。</p> <div class="language- extra-class"><pre class="language-text"><code>public static byte[] applyECDSASig(PrivateKey privateKey, String input) {
		Signature dsa;
		byte[] output = new byte[0];
		try {
			dsa = Signature.getInstance(&quot;ECDSA&quot;, &quot;BC&quot;);
			dsa.initSign(privateKey);
			byte[] strByte = input.getBytes();
			dsa.update(strByte);
			byte[] realSig = dsa.sign();
			output = realSig;
		} catch (Exception e) {
			throw new RuntimeException(e);
		}
		return output;
	}
	
	//Verifies a String signature 
	public static boolean verifyECDSASig(PublicKey publicKey, String data, byte[] signature) {
		try {
			Signature ecdsaVerify = Signature.getInstance(&quot;ECDSA&quot;, &quot;BC&quot;);
			ecdsaVerify.initVerify(publicKey);
			ecdsaVerify.update(data.getBytes());
			return ecdsaVerify.verify(signature);
		}catch(Exception e) {
			throw new RuntimeException(e);
		}
	}

	public static String getStringFromKey(Key key) {
		return Base64.getEncoder().encodeToString(key.getEncoded());
	}
</code></pre></div><p>不用担心你不能理解这些方法的内容，你所需要知道的就是applyECDSASig方法的输入参数为付款人的私钥和需要加密的数据信息，签名后返回字节数组。而verifyECDSASig方法的输入参数为公钥、加密的数据和签名，调用该方法后返回true或false来说明签名是否是有效的。getStringFromKey返回任何key的编码字符串</p> <p>让我们使用签名的方法在交易类中，增加generatesiganature() 和 varifiysignature()方法：</p> <div class="language- extra-class"><pre class="language-text"><code>//Signs all the data we dont wish to be tampered with.
public void generateSignature(PrivateKey privateKey) {
	String data = StringUtil.getStringFromKey(sender) + StringUtil.getStringFromKey(reciepient) + Float.toString(value)	;
	signature = StringUtil.applyECDSASig(privateKey,data);		
}
//Verifies the data we signed hasnt been tampered with
public boolean verifiySignature() {
	String data = StringUtil.getStringFromKey(sender) + StringUtil.getStringFromKey(reciepient) + Float.toString(value)	;
	return StringUtil.verifyECDSASig(sender, data, signature);
}
</code></pre></div><p>在现实中，您可能希望签名更多信息，例如使用的输出/输入和/或时间戳（现在我们只是签名最低限度的信息）</p> <p>签名将由矿工验证，只有签名验证成功后交易才能被添加到区块中去。</p> <h2 id="测试钱包和签名"><a href="#测试钱包和签名" class="header-anchor">#</a> 测试钱包和签名</h2> <p>现在我们简单的进行一些测试，在主方法中，我们增加了一些新的变量也替换了我们之前在主方法中的一些内容。</p> <div class="language- extra-class"><pre class="language-text"><code>import java.security.Security;
import java.util.ArrayList;
import java.util.Base64;
import com.google.gson.GsonBuilder;

public class NoobChain {
	
	public static ArrayList&lt;Block&gt; blockchain = new ArrayList&lt;Block&gt;();
	public static int difficulty = 5;
	public static Wallet walletA;
	public static Wallet walletB;

	public static void main(String[] args) {	
		//Setup Bouncey castle as a Security Provider
		Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider()); 
		//Create the new wallets
		walletA = new Wallet();
		walletB = new Wallet();
		//Test public and private keys
		System.out.println(&quot;Private and public keys:&quot;);
		System.out.println(StringUtil.getStringFromKey(walletA.privateKey));
		System.out.println(StringUtil.getStringFromKey(walletA.publicKey));
		//Create a test transaction from WalletA to walletB 
		Transaction transaction = new Transaction(walletA.publicKey, walletB.publicKey, 5, null);
		transaction.generateSignature(walletA.privateKey);
		//Verify the signature works and verify it from the public key
		System.out.println(&quot;Is signature verified&quot;);
		System.out.println(transaction.verifiySignature());
		
	}
</code></pre></div><p>确定要添加bounceycastle依赖</p> <p>我们创建了两个钱包walleta和walletb，然后打印了walleta的私钥和公钥。生成一个交易并使用walleta的私钥对其进行签名。</p> <p>打印</p> <div class="language- extra-class"><pre class="language-text"><code>Connected to the target VM, address: '127.0.0.1:55757', transport: 'socket'
Private and public keys:
MHsCAQAwEwYHKoZIzj0CAQYIKoZIzj0DAQEEYTBfAgEBBBiJzZiesBnBWwwB+uog+fJX84mx4lPUTUagCgYIKoZIzj0DAQGhNAMyAAQfPzad0zqBUGQAany2rRZE1+2ml5IOCZST8LywjBQT8ux+3UPVbr2u0+LaExxz1WI=
MEkwEwYHKoZIzj0CAQYIKoZIzj0DAQEDMgAEHz82ndM6gVBkAGp8tq0WRNftppeSDgmUk/C8sIwUE/Lsft1D1W69rtPi2hMcc9Vi
Is signature verified
true
</code></pre></div><p>接下来我们将创建并验证输入和输出，并把交易保存到区块链中去。</p> <h2 id="输入和输出-1-如何验证货币是你的"><a href="#输入和输出-1-如何验证货币是你的" class="header-anchor">#</a> 输入和输出 1：如何验证货币是你的</h2> <p>如果你拥有1比特币，你必须前面就得接收1比特币。比特币的账本不会在你的账户中增加一个比特币也不会从发送者那里减去一个比特币，发送者只能指向他/她之前收到过一个比特币，所以一个交易输出被创建用来显示一个比特币发送给你的地址（交易的输入指向前一个交易的输出）。</p> <p>你的钱包余额是所有未使用的交易输出的总和</p> <p>从这一个点出发，我们会依照比特币中的说明，把所有未使用的交易输出称为UTXO.</p> <p>创建TransactionInput 类：</p> <div class="language- extra-class"><pre class="language-text"><code>public class TransactionInput {
	public String transactionOutputId; //Reference to TransactionOutputs -&gt; transactionId
	public TransactionOutput UTXO; //Contains the Unspent transaction output
	
	public TransactionInput(String transactionOutputId) {
		this.transactionOutputId = transactionOutputId;
	}
}
</code></pre></div><p>这个类将用于引用尚未使用的transactionoutput。transactionOutputId将用于查找相关的TransactionOutput，允许矿工检查您的所有权。</p> <p>创建TransactionOutputs 类：</p> <div class="language- extra-class"><pre class="language-text"><code>import java.security.PublicKey;

public class TransactionOutput {
	public String id;
	public PublicKey reciepient; //also known as the new owner of these coins.
	public float value; //the amount of coins they own
	public String parentTransactionId; //the id of the transaction this output was created in
	
	//Constructor
	public TransactionOutput(PublicKey reciepient, float value, String parentTransactionId) {
		this.reciepient = reciepient;
		this.value = value;
		this.parentTransactionId = parentTransactionId;
		this.id = StringUtil.applySha256(StringUtil.getStringFromKey(reciepient)+Float.toString(value)+parentTransactionId);
	}
	
	//Check if coin belongs to you
	public boolean isMine(PublicKey publicKey) {
		return (publicKey == reciepient);
	}
	
}
</code></pre></div><p>交易输出类将显示从交易中发送给每一方的最终金额。这些作为新交易中的输入参考，作为证明你可以发送的金额数量。</p> <h2 id="输入和输出-2-处理交易"><a href="#输入和输出-2-处理交易" class="header-anchor">#</a> 输入和输出 2：处理交易</h2> <p>区块链可能会收到很多交易，而区块链可能会非常长，因为我们必须查找并检查其输入，所以可能需要非常长的时间来处理新的交易。为了解决这个问题，我们保存了一个额外的集合称之为为使用的交易作为可用的输入,所以在主函数中增加一个集合称为UTXO。</p> <div class="language- extra-class"><pre class="language-text"><code>public class NoobChain {
	
	public static ArrayList&lt;Block&gt; blockchain = new ArrayList&lt;Block&gt;();
	public static HashMap&lt;String,TransactionOutputs&gt; UTXOs = new HashMap&lt;String,TransactionOutputs&gt;(); //list of all unspent transactions. 
	public static int difficulty = 5;
	public static Wallet walletA;
	public static Wallet walletB;

	public static void main(String[] args) {
</code></pre></div><p>hashmap允许我们使用键来查找值，但是您需要导入java.util.hashmap</p> <p>重点来了，我们在交易类中增加一个processTransaction方法，这个方法是把一切放在一起用来处理交易。</p> <div class="language- extra-class"><pre class="language-text"><code>//Returns true if new transaction could be created.	
public boolean processTransaction() {
		
		if(verifiySignature() == false) {
			System.out.println(&quot;#Transaction Signature failed to verify&quot;);
			return false;
		}
				
		//gather transaction inputs (Make sure they are unspent):
		for(TransactionInput i : inputs) {
			i.UTXO = NoobChain.UTXOs.get(i.transactionOutputId);
		}

		//check if transaction is valid:
		if(getInputsValue() &lt; NoobChain.minimumTransaction) {
			System.out.println(&quot;#Transaction Inputs to small: &quot; + getInputsValue());
			return false;
		}
		
		//generate transaction outputs:
		float leftOver = getInputsValue() - value; //get value of inputs then the left over change:
		transactionId = calulateHash();
		outputs.add(new TransactionOutput( this.reciepient, value,transactionId)); //send value to recipient
		outputs.add(new TransactionOutput( this.sender, leftOver,transactionId)); //send the left over 'change' back to sender		
				
		//add outputs to Unspent list
		for(TransactionOutput o : outputs) {
			NoobChain.UTXOs.put(o.id , o);
		}
		
		//remove transaction inputs from UTXO lists as spent:
		for(TransactionInput i : inputs) {
			if(i.UTXO == null) continue; //if Transaction can't be found skip it 
			NoobChain.UTXOs.remove(i.UTXO.id);
		}
		
		return true;
	}
	
//returns sum of inputs(UTXOs) values
	public float getInputsValue() {
		float total = 0;
		for(TransactionInput i : inputs) {
			if(i.UTXO == null) continue; //if Transaction can't be found skip it 
			total += i.UTXO.value;
		}
		return total;
	}

//returns sum of outputs:
	public float getOutputsValue() {
		float total = 0;
		for(TransactionOutput o : outputs) {
			total += o.value;
		}
		return total;
	}
</code></pre></div><p>我们还添加了getinputsvalue方法</p> <p>通过这种方法，我们执行一些检查以确保交易有效，然后收集输入并生成输出。最重要的是，最后，我们抛弃了输入在我们的UTXO列表，这就意味着一个可以使用的交易输出必须之前一定是输入，所以输入的值必须被完全使用，所以付款人必须改变它们自身的金额状态。</p> <p>最后让我们修改我们的wallet类</p> <ul><li>搜集余额（通过循环遍历UTXO列表来检查交易的输出是否是我的）并</li> <li>创建交易</li></ul> <div class="language- extra-class"><pre class="language-text"><code>import java.security.*;
import java.security.spec.ECGenParameterSpec;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;

public class Wallet {
	
	public PrivateKey privateKey;
	public PublicKey publicKey;
	
	public HashMap&lt;String,TransactionOutput&gt; UTXOs = new HashMap&lt;String,TransactionOutput&gt;(); //only UTXOs owned by this wallet.
	
	public Wallet() {...
		
	public void generateKeyPair() {...
	
  //returns balance and stores the UTXO's owned by this wallet in this.UTXOs
	public float getBalance() {
		float total = 0;	
        for (Map.Entry&lt;String, TransactionOutput&gt; item: NoobChain.UTXOs.entrySet()){
        	TransactionOutput UTXO = item.getValue();
            if(UTXO.isMine(publicKey)) { //if output belongs to me ( if coins belong to me )
            	UTXOs.put(UTXO.id,UTXO); //add it to our list of unspent transactions.
            	total += UTXO.value ; 
            }
        }  
		return total;
	}
	//Generates and returns a new transaction from this wallet.
	public Transaction sendFunds(PublicKey _recipient,float value ) {
		if(getBalance() &lt; value) { //gather balance and check funds.
			System.out.println(&quot;#Not Enough funds to send transaction. Transaction Discarded.&quot;);
			return null;
		}
    //create array list of inputs
		ArrayList&lt;TransactionInput&gt; inputs = new ArrayList&lt;TransactionInput&gt;();
    
		float total = 0;
		for (Map.Entry&lt;String, TransactionOutput&gt; item: UTXOs.entrySet()){
			TransactionOutput UTXO = item.getValue();
			total += UTXO.value;
			inputs.add(new TransactionInput(UTXO.id));
			if(total &gt; value) break;
		}
		
		Transaction newTransaction = new Transaction(publicKey, _recipient , value, inputs);
		newTransaction.generateSignature(privateKey);
		
		for(TransactionInput input: inputs){
			UTXOs.remove(input.transactionOutputId);
		}
		return newTransaction;
	}
	
}
</code></pre></div><p>你可以随时为钱包添加一些其他功能，例如记录您的交易历史记录。</p> <h2 id="添加交易到区块中"><a href="#添加交易到区块中" class="header-anchor">#</a> 添加交易到区块中</h2> <p>现在我们已经有了一个有效的交易系统，我们需要把交易加入到我们的区块链中。我们把交易列表替换我们块中无用的数据，但是在一个单一的区块中可能存放了1000个交易，这就会导致大量的hash计算，不用担心在这里我们使用了交易的merkle root，稍后你会看到。让我们增加一个帮助方法来创建merkle root在StringUtils类中。</p> <p>在StringUtils类中创建getMerkleRoot方法</p> <div class="language- extra-class"><pre class="language-text"><code>//Tacks in array of transactions and returns a merkle root.
public static String getMerkleRoot(ArrayList&lt;Transaction&gt; transactions) {
		int count = transactions.size();
		ArrayList&lt;String&gt; previousTreeLayer = new ArrayList&lt;String&gt;();
		for(Transaction transaction : transactions) {
			previousTreeLayer.add(transaction.transactionId);
		}
		ArrayList&lt;String&gt; treeLayer = previousTreeLayer;
		while(count &gt; 1) {
			treeLayer = new ArrayList&lt;String&gt;();
			for(int i=1; i &lt; previousTreeLayer.size(); i++) {
				treeLayer.add(applySha256(previousTreeLayer.get(i-1) + previousTreeLayer.get(i)));
			}
			count = treeLayer.size();
			previousTreeLayer = treeLayer;
		}
		String merkleRoot = (treeLayer.size() == 1) ? treeLayer.get(0) : &quot;&quot;;
		return merkleRoot;
	}
</code></pre></div><p>我会尽快用一个实际的merkleroot取代这个方法，但是现在使用这个可以正常运行</p> <p>修来Block 类</p> <div class="language- extra-class"><pre class="language-text"><code>import java.util.ArrayList;
import java.util.Date;

public class Block {
	
	public String hash;
	public String previousHash; 
	public String merkleRoot;
	public ArrayList&lt;Transaction&gt; transactions = new ArrayList&lt;Transaction&gt;(); //our data will be a simple message.
	public long timeStamp; //as number of milliseconds since 1/1/1970.
	public int nonce;
	
	//Block Constructor.  
	public Block(String previousHash ) {
		this.previousHash = previousHash;
		this.timeStamp = new Date().getTime();
		
		this.hash = calculateHash(); //Making sure we do this after we set the other values.
	}
	
	//Calculate new hash based on blocks contents
	public String calculateHash() {
		String calculatedhash = StringUtil.applySha256( 
				previousHash +
				Long.toString(timeStamp) +
				Integer.toString(nonce) + 
				merkleRoot
				);
		return calculatedhash;
	}
	
	//Increases nonce value until hash target is reached.
	public void mineBlock(int difficulty) {
		merkleRoot = StringUtil.getMerkleRoot(transactions);
		String target = StringUtil.getDificultyString(difficulty); //Create a string with difficulty * &quot;0&quot; 
		while(!hash.substring( 0, difficulty).equals(target)) {
			nonce ++;
			hash = calculateHash();
		}
		System.out.println(&quot;Block Mined!!! : &quot; + hash);
	}
	
	//Add transactions to this block
	public boolean addTransaction(Transaction transaction) {
		//process transaction and check if valid, unless block is genesis block then ignore.
		if(transaction == null) return false;		
		if((previousHash != &quot;0&quot;)) {
			if((transaction.processTransaction() != true)) {
				System.out.println(&quot;Transaction failed to process. Discarded.&quot;);
				return false;
			}
		}
		transactions.add(transaction);
		System.out.println(&quot;Transaction Successfully added to Block&quot;);
		return true;
	}
	
}
</code></pre></div><p>需要注意的是我们还更新了Block构造函数，因为我们不再需要传递字符串数据，并将merkle root包含在计算哈希方法中。addTransaction方法用来增加交易，只有满足条件下才可以成功的在区块中增加交易。</p> <p>我们已经实现了一个可交易的区块链。</p> <h2 id="最后的测试"><a href="#最后的测试" class="header-anchor">#</a> 最后的测试</h2> <p>我们应该测试从钱包发送货币，更新区块链并进行有效性检查。但首先我们需要一种将新硬币引入混合的方法。有很多方法来创建新的硬币。在比特币区块链上，有很多方法可以创造新的比特币:矿工可以将交易包括在内，作为对每个矿工挖矿的奖励。但在这里我们只希望在创世纪区块中释放货币。就像比特币中一下，所以我们修改我们的主函数以达到下面的目的。</p> <ul><li>创世纪区块发布100个货币给walletA</li> <li>一个更新的链有效性检查，考虑到交易。</li> <li>测试交易看是否一切正常。</li></ul> <div class="language- extra-class"><pre class="language-text"><code>public class NoobChain {
	
	public static ArrayList&lt;Block&gt; blockchain = new ArrayList&lt;Block&gt;();
	public static HashMap&lt;String,TransactionOutput&gt; UTXOs = new HashMap&lt;String,TransactionOutput&gt;();
	
	public static int difficulty = 3;
	public static float minimumTransaction = 0.1f;
	public static Wallet walletA;
	public static Wallet walletB;
	public static Transaction genesisTransaction;

	public static void main(String[] args) {	
		//add our blocks to the blockchain ArrayList:
		Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider()); //Setup Bouncey castle as a Security Provider
		
		//Create wallets:
		walletA = new Wallet();
		walletB = new Wallet();		
		Wallet coinbase = new Wallet();
		
		//create genesis transaction, which sends 100 NoobCoin to walletA: 
		genesisTransaction = new Transaction(coinbase.publicKey, walletA.publicKey, 100f, null);
		genesisTransaction.generateSignature(coinbase.privateKey);	 //manually sign the genesis transaction	
		genesisTransaction.transactionId = &quot;0&quot;; //manually set the transaction id
		genesisTransaction.outputs.add(new TransactionOutput(genesisTransaction.reciepient, genesisTransaction.value, genesisTransaction.transactionId)); //manually add the Transactions Output
		UTXOs.put(genesisTransaction.outputs.get(0).id, genesisTransaction.outputs.get(0)); //its important to store our first transaction in the UTXOs list.
		
		System.out.println(&quot;Creating and Mining Genesis block... &quot;);
		Block genesis = new Block(&quot;0&quot;);
		genesis.addTransaction(genesisTransaction);
		addBlock(genesis);
		
		//testing
		Block block1 = new Block(genesis.hash);
		System.out.println(&quot;\nWalletA's balance is: &quot; + walletA.getBalance());
		System.out.println(&quot;\nWalletA is Attempting to send funds (40) to WalletB...&quot;);
		block1.addTransaction(walletA.sendFunds(walletB.publicKey, 40f));
		addBlock(block1);
		System.out.println(&quot;\nWalletA's balance is: &quot; + walletA.getBalance());
		System.out.println(&quot;WalletB's balance is: &quot; + walletB.getBalance());
		
		Block block2 = new Block(block1.hash);
		System.out.println(&quot;\nWalletA Attempting to send more funds (1000) than it has...&quot;);
		block2.addTransaction(walletA.sendFunds(walletB.publicKey, 1000f));
		addBlock(block2);
		System.out.println(&quot;\nWalletA's balance is: &quot; + walletA.getBalance());
		System.out.println(&quot;WalletB's balance is: &quot; + walletB.getBalance());
		
		Block block3 = new Block(block2.hash);
		System.out.println(&quot;\nWalletB is Attempting to send funds (20) to WalletA...&quot;);
		block3.addTransaction(walletB.sendFunds( walletA.publicKey, 20));
		System.out.println(&quot;\nWalletA's balance is: &quot; + walletA.getBalance());
		System.out.println(&quot;WalletB's balance is: &quot; + walletB.getBalance());
		
		isChainValid();
		
	}
	
	public static Boolean isChainValid() {
		Block currentBlock; 
		Block previousBlock;
		String hashTarget = new String(new char[difficulty]).replace('\0', '0');
		HashMap&lt;String,TransactionOutput&gt; tempUTXOs = new HashMap&lt;String,TransactionOutput&gt;(); //a temporary working list of unspent transactions at a given block state.
		tempUTXOs.put(genesisTransaction.outputs.get(0).id, genesisTransaction.outputs.get(0));
		
		//loop through blockchain to check hashes:
		for(int i=1; i &lt; blockchain.size(); i++) {
			
			currentBlock = blockchain.get(i);
			previousBlock = blockchain.get(i-1);
			//compare registered hash and calculated hash:
			if(!currentBlock.hash.equals(currentBlock.calculateHash()) ){
				System.out.println(&quot;#Current Hashes not equal&quot;);
				return false;
			}
			//compare previous hash and registered previous hash
			if(!previousBlock.hash.equals(currentBlock.previousHash) ) {
				System.out.println(&quot;#Previous Hashes not equal&quot;);
				return false;
			}
			//check if hash is solved
			if(!currentBlock.hash.substring( 0, difficulty).equals(hashTarget)) {
				System.out.println(&quot;#This block hasn't been mined&quot;);
				return false;
			}
			
			//loop thru blockchains transactions:
			TransactionOutput tempOutput;
			for(int t=0; t &lt;currentBlock.transactions.size(); t++) {
				Transaction currentTransaction = currentBlock.transactions.get(t);
				
				if(!currentTransaction.verifiySignature()) {
					System.out.println(&quot;#Signature on Transaction(&quot; + t + &quot;) is Invalid&quot;);
					return false; 
				}
				if(currentTransaction.getInputsValue() != currentTransaction.getOutputsValue()) {
					System.out.println(&quot;#Inputs are note equal to outputs on Transaction(&quot; + t + &quot;)&quot;);
					return false; 
				}
				
				for(TransactionInput input: currentTransaction.inputs) {	
					tempOutput = tempUTXOs.get(input.transactionOutputId);
					
					if(tempOutput == null) {
						System.out.println(&quot;#Referenced input on Transaction(&quot; + t + &quot;) is Missing&quot;);
						return false;
					}
					
					if(input.UTXO.value != tempOutput.value) {
						System.out.println(&quot;#Referenced input Transaction(&quot; + t + &quot;) value is Invalid&quot;);
						return false;
					}
					
					tempUTXOs.remove(input.transactionOutputId);
				}
				
				for(TransactionOutput output: currentTransaction.outputs) {
					tempUTXOs.put(output.id, output);
				}
				
				if( currentTransaction.outputs.get(0).reciepient != currentTransaction.reciepient) {
					System.out.println(&quot;#Transaction(&quot; + t + &quot;) output reciepient is not who it should be&quot;);
					return false;
				}
				if( currentTransaction.outputs.get(1).reciepient != currentTransaction.sender) {
					System.out.println(&quot;#Transaction(&quot; + t + &quot;) output 'change' is not sender.&quot;);
					return false;
				}
				
			}
			
		}
		System.out.println(&quot;Blockchain is valid&quot;);
		return true;
	}
	
	public static void addBlock(Block newBlock) {
		newBlock.mineBlock(difficulty);
		blockchain.add(newBlock);
	}
}
</code></pre></div><p>打印：</p> <div class="language- extra-class"><pre class="language-text"><code>Connected to the target VM, address: '127.0.0.1:57085', transport: 'socket'
Creating and Mining Genesis block... 
Transaction Successfully added to Block
Block Mined!!! : 000b5a7ca6bf07639122cb31e884996895a482c281dd89c203824f1e93a661bf

WalletA's balance is: 100.0

WalletA is Attempting to send funds (40) to WalletB...
Transaction Successfully added to Block
Block Mined!!! : 000c7f814357abfea86ad1b38ec1dc3afed2afc9107f2bacc933d8136bf34df0

WalletA's balance is: 60.0
WalletB's balance is: 40.0

WalletA Attempting to send more funds (1000) than it has...
#Not Enough funds to send transaction. Transaction Discarded.
Block Mined!!! : 000b3822fb7985db438712816727d4bc382926a1c4654062aad4071d9b9fad98

WalletA's balance is: 60.0
WalletB's balance is: 40.0

WalletB is Attempting to send funds (20) to WalletA...
Transaction Successfully added to Block

WalletA's balance is: 80.0
WalletB's balance is: 20.0
Blockchain is valid
</code></pre></div><p>现在钱包能够安全地在您的区块链上发送金额，只要他们有金额发送。这意味着你有你自己的本地加密货币</p> <p>可以进行交易的区块链</p> <p>你已经成功地创建了自己的加密货币。你的区块链：</p> <ul><li>允许用户创建钱包</li> <li>使用椭圆曲线加密方式为钱包提供公钥和私钥</li> <li>通过使用数字签名算法证明所有权，确保资金转移</li> <li>允许用户在区块链上进行交易</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/9/2022, 5:08:28 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.466dd957.js" defer></script><script src="/assets/js/2.733019b2.js" defer></script><script src="/assets/js/14.9c4dc8e5.js" defer></script>
  </body>
</html>
